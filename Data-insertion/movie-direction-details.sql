INSERT INTO director_table (movie_id, first_name, last_name, Date_of_birth, Address, Gender) VALUES
(1, 'S. S.', 'Rajamouli', '1973-10-10', 'Hyderabad, India', 'male'),
(2, 'S. S.', 'Rajamouli', '1973-10-10', 'Hyderabad, India', 'male'),
(3, 'Sukumar', '', '1970-01-11', 'Bheemavaram, India', 'male'),
(4, 'S. S.', 'Rajamouli', '1973-10-10', 'Hyderabad, India', 'male'),
(5, 'Prashanth', 'Neel', '1980-06-04', 'Bengaluru, India', 'male'),
(6, 'Prashanth', 'Neel', '1980-06-04', 'Bengaluru, India', 'male'),
(7, 'Prashanth', 'Neel', '1980-06-04', 'Bengaluru, India', 'male'),
(8, 'Om', 'Raut', '1981-12-21', 'Mumbai, India', 'male'),
(9, 'Sandeep', 'Reddy Vanga', '1981-12-25', 'Warangal, India', 'male'),
(10, 'Parasuram', '', '1982-06-02', 'Andhra Pradesh, India', 'male'),
(11, 'Trivikram', 'Srinivas', '1971-11-07', 'Andhra Pradesh, India', 'male'),
(12, 'Anil', 'Ravipudi', '1982-11-23', 'Andhra Pradesh, India', 'male'),
(13, 'Koratala', 'Siva', '1975-06-15', 'Andhra Pradesh, India', 'male'),
(14, 'S. S.', 'Rajamouli', '1973-10-10', 'Hyderabad, India', 'male'),
(15, 'Gowtam', 'Tinnanuri', '1985-04-21', 'Andhra Pradesh, India', 'male'),
(16, 'S. S.', 'Rajamouli', '1973-10-10', 'Hyderabad, India', 'male'),
(17, 'Harish', 'Shankar', '1980-03-31', 'Hyderabad, India', 'male'),
(18, 'Srinu', 'Vaitla', '1972-09-24', 'Andhra Pradesh, India', 'male'),
(19, 'S. S.', 'Rajamouli', '1973-10-10', 'Hyderabad, India', 'male'),
(20, 'Puri', 'Jagannadh', '1966-09-28', 'Andhra Pradesh, India', 'male'),
(21, 'S. S.', 'Rajamouli', '1973-10-10', 'Hyderabad, India', 'male'),
(22, 'Vassishta', '', '1985-07-20', 'Andhra Pradesh, India', 'male'),
(23, 'Trivikram', 'Srinivas', '1971-11-07', 'Andhra Pradesh, India', 'male'),
(24, 'Sukumar', '', '1970-01-11', 'Bheemavaram, India', 'male'),
(25, 'Sukumar', '', '1970-01-11', 'Bheemavaram, India', 'male'),
(26, 'Sukumar', '', '1970-01-11', 'Bheemavaram, India', 'male'),
(27, 'Lokesh', 'Kanagaraj', '1986-03-14', 'Tamil Nadu, India', 'male'),
(28, 'Lokesh', 'Kanagaraj', '1986-03-14', 'Tamil Nadu, India', 'male'),
(29, 'Lokesh', 'Kanagaraj', '1986-03-14', 'Tamil Nadu, India', 'male'),
(30, 'Nelson', 'Dilipkumar', '1984-06-21', 'Tamil Nadu, India', 'male'),
(31, 'H. Vinoth', '', '1979-09-05', 'Tamil Nadu, India', 'male'),
(32, 'Vamshi', 'Paidipally', '1979-10-10', 'Andhra Pradesh, India', 'male'),
(33, 'Lokesh', 'Kanagaraj', '1986-03-14', 'Tamil Nadu, India', 'male'),
(34, 'Atlee', '', '1986-09-21', 'Tamil Nadu, India', 'male'),
(35, 'Atlee', '', '1986-09-21', 'Tamil Nadu, India', 'male'),
(36, 'A. R.', 'Murugadoss', '1974-09-25', 'Tamil Nadu, India', 'male'),
(37, 'Pa. Ranjith', '', '1982-12-08', 'Tamil Nadu, India', 'male'),
(38, 'Shankar', '', '1963-08-17', 'Tamil Nadu, India', 'male'),
(39, 'Shankar', '', '1963-08-17', 'Tamil Nadu, India', 'male'),
(40, 'Shankar', '', '1963-08-17', 'Tamil Nadu, India', 'male'),
(41, 'S. Shankar', '', '1963-08-17', 'Tamil Nadu, India', 'male'),
(42, 'Jeethu', 'Joseph', '1972-06-10', 'Kerala, India', 'male'),
(43, 'Vetrimaaran', '', '1975-09-04', 'Tamil Nadu, India', 'male'),
(44, 'Thiagarajan', 'Kumararaja', '1977-12-15', 'Tamil Nadu, India', 'male'),
(45, 'Venkat', 'Prabhu', '1975-11-07', 'Tamil Nadu, India', 'male'),
(46, 'Karthik', 'Subbaraj', '1983-03-19', 'Tamil Nadu, India', 'male'),
(47, 'Atlee', '', '1986-09-21', 'Tamil Nadu, India', 'male'),
(48, 'Sudha', 'Kongara', '1971-03-29', 'Tamil Nadu, India', 'female'),
(49, 'Vetrimaaran', '', '1975-09-04', 'Tamil Nadu, India', 'male'),
(50, 'Sudha', 'Kongara', '1971-03-29', 'Tamil Nadu, India', 'female'),
(51, 'Christopher', 'Nolan', '1970-07-30', 'London, UK', 'male'),
(52, 'Christopher', 'Nolan', '1970-07-30', 'London, UK', 'male'),
(53, 'Christopher', 'Nolan', '1970-07-30', 'London, UK', 'male'),
(54, 'Frank', 'Darabont', '1959-01-28', 'Montb√©liard, France', 'male'),
(55, 'Francis Ford', 'Coppola', '1939-04-07', 'Detroit, USA', 'male'),
(56, 'Francis Ford', 'Coppola', '1939-04-07', 'Detroit, USA', 'male'),
(57, 'Lana', 'Wachowski', '1965-06-21', 'Chicago, USA', 'female'),
(58, 'James', 'Cameron', '1954-08-16', 'Ontario, Canada', 'male'),
(59, 'James', 'Cameron', '1954-08-16', 'Ontario, Canada', 'male'),
(60, 'James', 'Cameron', '1954-08-16', 'Ontario, Canada', 'male'),
(61, 'Christopher', 'Nolan', '1970-07-30', 'London, UK', 'male'),
(62, 'Christopher', 'Nolan', '1970-07-30', 'London, UK', 'male'),
(63, 'Christopher', 'Nolan', '1970-07-30', 'London, UK', 'male'),
(64, 'David', 'Fincher', '1962-08-28', 'Denver, USA', 'male'),
(65, 'Todd', 'Phillips', '1970-12-20', 'New York, USA', 'male'),
(66, 'Denis', 'Villeneuve', '1967-10-03', 'Quebec, Canada', 'male'),
(67, 'Denis', 'Villeneuve', '1967-10-03', 'Quebec, Canada', 'male'),
(68, 'Joss', 'Whedon', '1964-06-23', 'New York, USA', 'male'),
(69, 'Anthony', 'Russo', '1970-02-03', 'Cleveland, USA', 'male'),
(70, 'Anthony', 'Russo', '1970-02-03', 'Cleveland, USA', 'male'),
(71, 'Jon', 'Watts', '1981-06-28', 'Colorado, USA', 'male'),
(72, 'Scott', 'Derrickson', '1966-07-16', 'Denver, USA', 'male'),
(73, 'James', 'Gunn', '1966-08-05', 'St. Louis, USA', 'male'),
(74, 'Tim', 'Miller', '1964-10-10', 'Fort Washington, USA', 'male'),
(75, 'James', 'Mangold', '1963-12-16', 'New York, USA', 'male'),
(76, 'Atlee', '', '1986-09-21', 'Tamil Nadu, India', 'male'),
(77, 'Siddharth', 'Anand', '1978-07-31', 'Mumbai, India', 'male'),
(78, 'Maneesh', 'Sharma', '1981-06-15', 'Delhi, India', 'male'),
(79, 'Ayan', 'Mukerji', '1983-08-15', 'Mumbai, India', 'male'),
(80, 'Anil', 'Sharma', '1955-03-07', 'Uttar Pradesh, India', 'male'),
(81, 'Sandeep', 'Reddy Vanga', '1981-12-25', 'Warangal, India', 'male'),
(82, 'Rajkumar', 'Hirani', '1962-11-20', 'Nagpur, India', 'male'),
(83, 'Rajkumar', 'Hirani', '1962-11-20', 'Nagpur, India', 'male'),
(84, 'Nitesh', 'Tiwari', '1973-05-19', 'Madhya Pradesh, India', 'male'),
(85, 'Ashutosh', 'Gowariker', '1964-02-15', 'Maharashtra, India', 'male'),
(86, 'Aamir', 'Khan', '1965-03-14', 'Mumbai, India', 'male'),
(87, 'Ramesh', 'Sippy', '1947-01-23', 'Mumbai, India', 'male'),
(88, 'K. Asif', '', '1922-06-14', 'Etawah, India', 'male'),
(89, 'Sandeep', 'Reddy Vanga', '1981-12-25', 'Warangal, India', 'male'),
(90, 'Kabir', 'Khan', '1971-09-14', 'Delhi, India', 'male'),
(91, 'Ali', 'Abbas Zafar', '1982-01-17', 'Dehradun, India', 'male'),
(92, 'Rohit', 'Shetty', '1974-03-14', 'Mumbai, India', 'male'),
(93, 'Rohit', 'Shetty', '1974-03-14', 'Mumbai, India', 'male'),
(94, 'Rakesh', 'Roshan', '1949-09-06', 'Mumbai, India', 'male'),
(95, 'Zoya', 'Akhtar', '1972-10-14', 'Mumbai, India', 'female'),
(96, 'Siddharth', 'Anand', '1978-07-31', 'Mumbai, India', 'male'),
(97, 'Zoya', 'Akhtar', '1972-10-14', 'Mumbai, India', 'female'),
(98, 'Rahul', 'Dholakia', '1969-01-25', 'Mumbai, India', 'male'),
(99, 'Nishikant', 'Kamat', '1970-06-17', 'Mumbai, India', 'male'),
(100, 'Jeethu', 'Joseph', '1982-11-10', 'Kerala, India', 'male');


CREATE TABLE movie_directors (
   movie_id INT,
   director_id INT,
   PRIMARY KEY (movie_id, director_id),
   FOREIGN KEY (movie_id) REFERENCES movies_table(movie_id) ,
   FOREIGN KEY (director_id) REFERENCES directors(director_id)
);

CREATE TABLE directors (
   director_id INT AUTO_INCREMENT PRIMARY KEY,
   first_name VARCHAR(50),
   last_name VARCHAR(50),
   date_of_birth DATE,
   address TEXT,
   gender ENUM('female','male') NOT NULL
);
drop table movie_directors;
drop table director_table;

INSERT INTO directors (first_name, last_name, date_of_birth, address, gender)
SELECT DISTINCT first_name, last_name, date_of_birth, address, gender FROM director_table;

INSERT INTO movie_directors ( director_id,movie_id)
SELECT dr.director_id,d.movie_id
FROM director_table d
JOIN directors dr 
ON d.first_name = dr.first_name
AND d.last_name = dr.last_name
AND d.date_of_birth = dr.date_of_birth
AND d.address = dr.address
AND d.gender = dr.gender;


